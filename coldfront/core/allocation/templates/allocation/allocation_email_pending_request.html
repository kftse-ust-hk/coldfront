{% extends "common/base.html" %}
{% load crispy_forms_tags %}
{% load static %}


{% block title %}
Allocation Review New Requests
{% endblock %}


{% block content %}
<div class="max-w-7xl mx-auto">
  <!-- Page Title -->
  <div class="mb-8">
    <h2 class="text-3xl font-bold text-primary-950">Email</h2>
    <div class="mt-2 h-1 w-16 bg-secondary-500 rounded"></div>
  </div>

  <div class="bg-white shadow-sm rounded-lg border border-gray-200 mb-6">
    <div class="px-6 py-4 border-b border-gray-200">
      <h3 class="text-lg font-semibold text-gray-900 flex items-center">
        <i class="fas fa-list text-gray-500 mr-2" aria-hidden="true"></i> 
        Allocation Information
      </h3>
    </div>
    <div class="p-6">
      <div class="overflow-x-auto">
        <table class="w-full border border-gray-200 rounded-lg overflow-hidden">
          <tbody class="bg-white divide-y divide-gray-200">
            <tr>
              <th scope="row" class="px-6 py-4 bg-gray-50 text-left text-sm font-medium text-gray-500 whitespace-nowrap w-1/3">Project:</th>
              <td class="px-6 py-4 text-sm text-gray-900">
                <a href="{% url 'project-detail' allocation.project.pk %}" class="text-primary-600 hover:text-primary-800 font-medium">{{ allocation.project }}</a>
              </td>
            </tr>
            <tr>
              <th scope="row" class="px-6 py-4 bg-gray-50 text-left text-sm font-medium text-gray-500 whitespace-nowrap w-1/3">PI:</th>
              <td class="px-6 py-4 text-sm text-gray-900">
                {{allocation.project.pi.first_name}} {{allocation.project.pi.last_name}} ({{allocation.project.pi.username}})
              </td>
            </tr>
            <tr>
              <th scope="row" class="px-6 py-4 bg-gray-50 text-left text-sm font-medium text-gray-500 whitespace-nowrap w-1/3">Resource:</th>
              <td class="px-6 py-4 text-sm text-gray-900">{{ allocation.resources.first }}</td>
            </tr>
            <tr>
              <th scope="row" class="px-6 py-4 bg-gray-50 text-left text-sm font-medium text-gray-500 whitespace-nowrap w-1/3">Justification:</th>
              <td class="px-6 py-4 text-sm text-gray-900">{{ allocation.justification }}</td>
            </tr>
            <tr>
              <th scope="row" class="px-6 py-4 bg-gray-50 text-left text-sm font-medium text-gray-500 whitespace-nowrap w-1/3">Date Requested:</th>
              <td class="px-6 py-4 text-sm text-gray-900">{{ allocation.created }}</td>
            </tr>
            <tr>
              <th scope="row" class="px-6 py-4 bg-gray-50 text-left text-sm font-medium text-gray-500 whitespace-nowrap w-1/3">Grants Last Updated:</th>
              <td class="px-6 py-4 text-sm text-gray-900">{{allocation.project.latest_grant.created|date:"M-d-Y"|default:"No grants"}}</td>
            </tr>
            <tr>
              <th scope="row" class="px-6 py-4 bg-gray-50 text-left text-sm font-medium text-gray-500 whitespace-nowrap w-1/3">Publications Last Updated:</th>
              <td class="px-6 py-4 text-sm text-gray-900">{{allocation.project.latest_publication.created|date:"M-d-Y"|default:"No publications"}}</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <div class="bg-white shadow-sm rounded-lg border border-gray-200 p-6">
    <form method="post">
      {% csrf_token %}
      {{form|crispy}}
      
      <div class="flex gap-3 mt-6 pt-6 border-t border-gray-200">
        <button type="submit" class="inline-flex items-center px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 transition-colors duration-200">
          Email
        </button>
        <a href="{% url 'allocation-review-pending-requests' %}" class="inline-flex items-center px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition-colors duration-200">
          Cancel
        </a>
      </div>
    </form>
  </div>
</div>
{% endblock %}
